<?xml version="1.0" encoding="utf-8"?>
<Package 
	xmlns="http://schemas.microsoft.com/appx/manifest/foundation/windows10" 
	xmlns:uap="http://schemas.microsoft.com/appx/manifest/uap/windows10" 
	xmlns:rescap="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities" 
	xmlns:uap3="http://schemas.microsoft.com/appx/manifest/uap/windows10/3"
	xmlns:uap5="http://schemas.microsoft.com/appx/manifest/uap/windows10/5" 
	xmlns:uap10="http://schemas.microsoft.com/appx/manifest/uap/windows10/10" 
    xmlns:uap13="http://schemas.microsoft.com/appx/manifest/uap/windows10/13" 
	xmlns:desktop="http://schemas.microsoft.com/appx/manifest/desktop/windows10"
	xmlns:desktop2="http://schemas.microsoft.com/appx/manifest/desktop/windows10/2"
    xmlns:desktop6="http://schemas.microsoft.com/appx/manifest/desktop/windows10/6"
	IgnorableNamespaces="uap uap3 uap5 uap10 uap13 desktop6 rescap">
  <Identity Name="Devenv" Publisher="CN=nixos-devenv" Version="@VERSION@" ProcessorArchitecture="x64" />
  <Properties>
    <DisplayName>Devenv</DisplayName>
    <PublisherDisplayName>nixos-devenv</PublisherDisplayName>
    <Description>Devenv via NixOS</Description>
    <Logo>Assets\StoreLogo.png</Logo>
    <uap10:PackageIntegrity>
      <uap10:Content Enforcement="on" />
    </uap10:PackageIntegrity>
    <uap13:AutoUpdate>
        <uap13:AppInstaller File="devenv.AppInstaller" />
    </uap13:AutoUpdate>
  </Properties>
  <Resources>
    <Resource Language="en-us" />
  </Resources>
  <Dependencies>
    <TargetDeviceFamily Name="Windows.Desktop" MinVersion="10.0.17763.0" MaxVersionTested="10.0.22000.1" />
  </Dependencies>
  <Applications>
    <Application Id="Devenv.App" Executable="devenv.exe" EntryPoint="Windows.FullTrustApplication" uap10:Parameters="start">
      <uap:VisualElements DisplayName="Devenv" Description="Start Devenv" 
			Square150x150Logo="Assets\StoreLogo.png"  Square44x44Logo="Assets\StoreLogo.png" 
			BackgroundColor="transparent"  AppListEntry="default">
	    <uap:DefaultTile ShortName="Start Devenv">
          <uap:ShowNameOnTiles>
            <uap:ShowOn Tile="square150x150Logo" />
          </uap:ShowNameOnTiles>
        </uap:DefaultTile>
      </uap:VisualElements>
      <!-- <Extensions> -->
      <!--   <uap5:Extension Category="windows.appExecutionAlias" Executable="devenv.exe" EntryPoint="Windows.FullTrustApplication" uap10:Parameters="start"> -->
      <!--     <uap5:AppExecutionAlias> -->
      <!--       <uap5:ExecutionAlias Alias="devenv-server.exe" /> -->
      <!--     </uap5:AppExecutionAlias> -->
      <!--   </uap5:Extension> -->
      <!-- </Extensions> -->
    </Application>
    <Application Id="DevenvCLI.App" Executable="devenv.exe" EntryPoint="Windows.FullTrustApplication">
      <uap:VisualElements DisplayName="Devenv CLI" Description="Devenv CLI" 
			Square150x150Logo="Assets\StoreLogo.png"  Square44x44Logo="Assets\StoreLogo.png" 
			BackgroundColor="transparent" AppListEntry="none"/>
      <Extensions>
        <uap5:Extension Category="windows.appExecutionAlias" Executable="devenv.exe" EntryPoint="Windows.FullTrustApplication">
          <uap5:AppExecutionAlias>
            <uap5:ExecutionAlias Alias="devenv.exe" />
          </uap5:AppExecutionAlias>
        </uap5:Extension>
      </Extensions>
    </Application>
  </Applications>
  <Capabilities>
    <rescap:Capability Name="runFullTrust" />
    <!-- <DeviceCapability Name="microphone" /> -->
    <!-- <DeviceCapability Name="webcam" /> -->
    <!-- <DeviceCapability Name="bluetooth" /> -->
  </Capabilities>
  <Extensions>
	<desktop2:Extension Category="windows.firewallRules">
  	  <desktop2:FirewallRules Executable="VFS\ProgramFilesX64\VcXsrv\devenv_vcxsrv.exe">
        <desktop2:Rule Direction="in" IPProtocol="TCP" LocalPortMax="6000" LocalPortMin="6000" Profile="all"/>
  	  </desktop2:FirewallRules>
	</desktop2:Extension>
	<desktop2:Extension Category="windows.firewallRules">
  	  <desktop2:FirewallRules Executable="VFS\ProgramFilesX86\PulseAudio\bin\devenv_pulseaudio.exe">
        <desktop2:Rule Direction="in" IPProtocol="TCP" LocalPortMax="4713" LocalPortMin="4713" Profile="all"/>
  	  </desktop2:FirewallRules>
	</desktop2:Extension>
  </Extensions>
</Package>
